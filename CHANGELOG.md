# Changelog

- Fix base-model generation to use the current database connection when reading table columns, avoiding SQLite "No connection" errors.
- Fix base-model generation to honor the configured project directory instead of always using the current working directory.
- Fix background job status reporting timeout to use milliseconds so network round trips are not prematurely aborted.
- Move background job CLI commands into the Node environment handler so browser builds avoid Node-only imports.
- Add README examples for configuring CLI command loading in Node and browser environments.
- Add browser system test runner and browser-safe test app harness for System Testing.
- Add dummy-tag handling for browser tests with a SQLite web driver setup.
- Add a Peakflow build step for browser system tests.
- Fix dummy helper path resolution when running tests from spec/dummy.
- Normalize dummy helper path resolution to avoid trailing-slash mismatches.
- Run dummy migrations for browser tests instead of loading structure SQL.
- Enable browser coverage for preloader belongs-to and has-many record specs.
- Enable browser coverage for database query specs.
- Enable browser coverage for migration specs that use dummy models.
- Enable browser coverage for utility specs.
- Allow preload shorthand forms like `{project: \"translations\"}` and `{project: [\"translations\", \"projectDetail\"]}`.
- Allow join shorthand forms like `{project: \"translations\"}` and `{project: [\"translations\", \"projectDetail\"]}`.
- Merge join array branches targeting the same relationship so nested joins are preserved.
- Require a test-file require context when importing browser tests to avoid bundling unintended files.
- Enable browser coverage for table data, transactions, and selected driver specs.
- Add npm release patch script entrypoint and ensure npm login before publishing.
- Refactor release patch script to Node for cross-platform usage.
- Document the user module in the README.
- Add mailer support with EJS rendering, background job delivery, and test delivery tracking.
- Add configurable mailer backends with a built-in SMTP backend.
- Prefer app-defined background jobs over built-in ones when names collide.
- Type cast values for `insertMultiple` based on column types.
- Insert SQL now renders null values as SQL NULL.
- Implement `insertMultiple` for MySQL, MariaDB, PostgreSQL, and MSSQL drivers.
- Move shared `insertMultiple` implementation into the base driver.
- Validate `insertMultiple` row lengths against column count.
- Preserve numeric strings for decimal/numeric columns and unsafe integers.
- Ensure dummy app stops even when tests fail.
- Order SQLite structure SQL with tables before indexes.
- Use gettext-universal as the default translator and expose `_` in mailer views.
- Document translation setup and mailer view translations in the README.
- Fix default translator fallback handling for validation attribute names.
- Clear gettext locale fallbacks when no locale is resolved.
- Emit testRetrying before a retry attempt and testRetried after it finishes.
- Document test retry events in the README.
- Document how to run CLI commands in the browser.
- Add insertMultiple retry-on-failure with per-row results reporting.
- Safely serialize insertMultiple failed rows with BigInt/circular handling.
- Document insertMultiple usage in the README.
- Add controller cookie helpers with encrypted cookie support.
- Normalize undefined encrypted cookie values to avoid cipher errors.
- Log when retrying a test.
- Color retry logs red with picocolors.
- Color test failure logs red with picocolors.
- Color CLI test summaries with picocolors.
- Retry MySQL queries on connection failures with reconnect attempts.
- Prevent reconnect retries when a transaction is active to avoid bypassing transactions.
- Use env-sense to force console logging APIs in browsers.
- Treat large integer request timeout env values as milliseconds to avoid unintended long waits.
- Support chunked HTTP request bodies and broader HTTP methods to prevent request parsing hangs.
- Close HTTP/1.1 connections when clients request `Connection: close`.
- Treat `Connection: close` as a token in comma-separated HTTP/1.1 Connection headers.
- Allow instance mailer actions to return delivery wrappers for `new Mailer().action(...).deliverLater()` usage.
- Remove mailer class proxies and require instance action delivery for mailers.
- Require mailer actions to return `mail(...)` with an explicit action name.
- Support async mailer setup via `actionPromise` on `mail(...)`.
- Allow configuring the browser test HTTP host/port via `SYSTEM_TEST_HTTP_HOST`/`SYSTEM_TEST_HTTP_PORT`.
- Prevent reused request params from leaking controller/action between requests.
- Disallow reusing a request parser after completion to enforce one-request-per-parser.
- Preserve leftover bytes to support HTTP/1.0 keep-alive requests in a single socket write.
- Copy JS templates into build output so CLI generation can find them after `npm run build`.
- Exclude `src/build` from TypeScript compilation so `npm run build` succeeds.
- Add websocketMessageHandlerResolver to support raw websocket message handlers outside the standard request/subscribe protocol.
- Copy templates into build/src/templates so CLI template paths resolve after builds.
- Remove `src/build` template sources in favor of `src/templates`.
- Preserve `src/routes` when copying EJS templates into build output.
- Gate worker client close logs behind debug logging.
- Add a Node console CLI command with `console`/`c` aliases and REPL context setup.
- Allow disabling MSSQL connections via `VELOCIOUS_DISABLE_MSSQL=1` or `VELOCIOUS_DISABLED_DATABASE_IDENTIFIERS`.
- Respect configured MSSQL schemas when listing tables, and skip schema filtering when none is provided.
